function module(n,e,t){var i,r,u,o,a,c,l,s,f,d;t.link("@babel/runtime/helpers/objectWithoutProperties",{default:function(n){i=n}},0),t.link("@babel/runtime/regenerator",{default:function(n){r=n}},1),t.link("meteor/meteor",{Meteor:function(n){u=n}},0),t.link("meteor/templating",{Template:function(n){o=n}},1),t.link("meteor/reactive-var",{ReactiveVar:function(n){a=n}},2),t.link("meteor/kadira:flow-router",{FlowRouter:function(n){c=n}},3),t.link("../../../../models",{ChatRoom:function(n){l=n}},4),t.link("../../../../ui-utils/client",{call:function(n){s=n}},5),t.link("./livechatReadOnly.html"),t.link("../../../../utils/client",{APIClient:function(n){f=n}},6),t.link("../../lib/stream/inquiry",{inquiryDataStream:function(n){d=n}},7),o.livechatReadOnly.helpers({inquiryOpen:function(){var n=o.instance().inquiry.get();return n&&"queued"===n.status},roomOpen:function(){var n=o.instance().room.get();return n&&!0===n.open},showPreview:function(){var n;return o.instance().routingConfig.get().previewRoom},isPreparing:function(){return o.instance().preparing.get()}}),o.livechatReadOnly.events({"click .js-take-it":function(){function n(n,e){var t,i;return r.async(function(){function u(u){for(;;)switch(u.prev=u.next){case 0:return n.preventDefault(),n.stopPropagation(),t=e.inquiry.get(),i=t._id,u.next=6,r.awrap(s("livechat:takeInquiry",i));case 6:e.loadInquiry(t.rid);case 7:case"end":return u.stop()}}return u}(),null,null,null,Promise)}return n}()}),o.livechatReadOnly.onCreated((function(){var n=this;this.rid=o.currentData().rid,this.room=new a,this.inquiry=new a,this.routingConfig=new a({}),this.preparing=new a(!0),this.updateInquiry=function(){function e(e){var t,o;return r.async(function(){function a(a){for(;;)switch(a.prev=a.next){case 0:if(t=e.clientAction,o=i(e,["clientAction"]),a.t0="removed"===t,a.t0){a.next=6;break}return a.next=5,r.awrap(s("canAccessRoom",o.rid,u.userId()));case 5:a.t0=!a.sent;case 6:if(!a.t0){a.next=8;break}return a.abrupt("return",c.go("/home"));case 8:n.inquiry.set(o);case 9:case"end":return a.stop()}}return a}(),null,null,null,Promise)}return e}(),u.call("livechat:getRoutingConfig",(function(e,t){t&&n.routingConfig.set(t)})),this.loadInquiry=function(){function e(e){var t,i;return r.async(function(){function u(u){for(;;)switch(u.prev=u.next){case 0:return n.preparing.set(!0),u.next=3,r.awrap(f.v1.get("livechat/inquiries.getOne?roomId="+e));case 3:t=u.sent,i=t.inquiry,n.inquiry.set(i),i&&i._id&&d.on(i._id,n.updateInquiry),n.preparing.set(!1);case 8:case"end":return u.stop()}}return u}(),null,null,null,Promise)}return e}(),this.autorun((function(){return n.loadInquiry(n.rid)})),this.autorun((function(){n.room.set(l.findOne({_id:o.currentData().rid},{fields:{open:1}}))}))})),o.livechatReadOnly.onDestroyed((function(){var n=this.inquiry.get();n&&n._id&&d.removeListener(n._id,this.updateInquiry)}))}

