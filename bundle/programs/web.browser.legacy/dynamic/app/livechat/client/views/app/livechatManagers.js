function module(e,n,t){var a,r,s,i,o,c,u,l,f,g,m,d;t.link("@babel/runtime/helpers/toConsumableArray",{default:function(e){a=e}},0),t.link("@babel/runtime/regenerator",{default:function(e){r=e}},1),t.link("meteor/meteor",{Meteor:function(e){s=e}},0),t.link("meteor/templating",{Template:function(e){i=e}},1),t.link("meteor/reactive-var",{ReactiveVar:function(e){o=e}},2),t.link("meteor/reactive-dict",{ReactiveDict:function(e){c=e}},3),t.link("underscore",{default:function(e){u=e}},4),t.link("../../../../ui-utils",{modal:function(e){l=e},call:function(e){f=e}},5),t.link("../../../../utils",{t:function(e){g=e},handleError:function(e){m=e}},6),t.link("../../../../utils/client",{APIClient:function(e){d=e}},7),t.link("./livechatManagers.html");var v=50,h=500,p=function(e){return e.username};i.livechatManagers.helpers({exceptionsManagers:function(){var e,n=i.instance().selectedManagers;return i.instance().managers.get().map(p).concat(n.get().map(p))},deleteLastManager:function(){var e=i.instance();return function(){var n=e.selectedManagers.curValue;n.pop(),e.selectedManagers.set(n)}},isLoading:function(){return i.instance().state.get("loading")},managers:function(){return i.instance().managers.get()},emailAddress:function(){if(this.emails&&this.emails.length>0)return this.emails[0].address},managerModifier:function(){return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=e.get();return"@"+(0===t.length?n:n.replace(new RegExp(e.get()),(function(e){return"<strong>"+e+"</strong>"})))}},onSelectManagers:function(){return i.instance().onSelectManagers},selectedManagers:function(){return i.instance().selectedManagers.get()},onClickTagManagers:function(){return i.instance().onClickTagManagers},onTableScroll:function(){var e=i.instance();return function(n){if(!(n.offsetHeight+n.scrollTop<n.scrollHeight-100)){var t=e.managers.get();e.total.get()>t.length&&e.offset.set(e.offset.get()+v)}}}}),i.livechatManagers.events({"click .remove-manager":function(e,n){var t=this;e.preventDefault(),l.open({title:g("Are_you_sure"),type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:g("Yes"),cancelButtonText:g("Cancel"),closeOnConfirm:!1,html:!1},(function(){s.call("livechat:removeManager",t.username,(function(e){if(e)return m(e);n.loadManagers(n.filter.get(),0),l.open({title:g("Removed"),text:g("Manager_removed"),type:"success",timer:1e3,showConfirmButton:!1})}))}))},"submit #form-manager":function(){function e(e,n){var t,a,s;return r.async(function(){function i(i){for(;;)switch(i.prev=i.next){case 0:if(e.preventDefault(),t=n.selectedManagers,a=n.state,(s=t.get()).length){i.next=5;break}return i.abrupt("return");case 5:return a.set("loading",!0),i.prev=6,i.next=9,r.awrap(Promise.all(s.map((function(e){var n=e.username;return f("livechat:addManager",n)}))));case 9:t.set([]);case 10:return i.prev=10,a.set("loading",!1),n.loadManagers(n.filter.get(),0),i.finish(10);case 14:case"end":return i.stop()}}return i}(),null,null,[[6,,10,14]],Promise)}return e}(),"keydown #managers-filter":function(e){13===e.which&&(e.stopPropagation(),e.preventDefault())},"keyup #managers-filter":u.debounce((function(e,n){e.stopPropagation(),e.preventDefault(),n.filter.set(e.currentTarget.value),n.offset.set(0)}),500)}),i.livechatManagers.onCreated((function(){var e=this,n=this;this.offset=new o(0),this.filter=new o(""),this.state=new c({loading:!1}),this.total=new o(0),this.managers=new o([]),this.selectedManagers=new o([]),this.onSelectManagers=function(n){var t=n.item;e.selectedManagers.set([].concat(a(e.selectedManagers.curValue),[t]))},this.onClickTagManagers=function(n){var t=n.username;e.selectedManagers.set(e.selectedManagers.curValue.filter((function(e){return e.username!==t})))},this.loadManagers=u.debounce(function(){function n(n,t){var a,s,i,o;return r.async(function(){function c(c){for(;;)switch(c.prev=c.next){case 0:return e.state.set("loading",!0),a="livechat/users/manager?count="+v+"&offset="+t,n&&(a+="&text="+encodeURIComponent(n)),c.next=5,r.awrap(d.v1.get(a));case 5:s=c.sent,i=s.users,o=s.total,e.total.set(o),0===t?e.managers.set(i):e.managers.set(e.managers.get().concat(i)),e.state.set("loading",!1);case 11:case"end":return c.stop()}}return c}(),null,null,null,Promise)}return n}(),500),this.autorun(function(){function t(){var t,a;return r.async(function(){function r(r){for(;;)switch(r.prev=r.next){case 0:return t=n.filter.get(),a=n.offset.get(),r.abrupt("return",e.loadManagers(t,a));case 3:case"end":return r.stop()}}return r}(),null,null,null,Promise)}return t}())}))}

